:root{ --bg:#f6efe6; --card:#fffaf2; --muted:#6b5e4a; --accent:#8b6b3b }
*{box-sizing:border-box}
.topbar{display:flex;justify-content:space-between;align-items:center;padding:10px 16px;background:linear-gradient(90deg,#fffaf2,#f6efe6);border-bottom:1px solid rgba(0,0,0,0.04);position:fixed;left:72px;right:0;top:0;z-index:60;width:100%}
.topbar h1{margin:0;font-size:18px}
.controls{display:flex;gap:10px;align-items:center}
.input{padding:8px 10px;border:1px solid #dbeafe;border-radius:8px}
.input.wide{width:360px}
.btn{background:var(--accent);color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer}
.btn.muted{background:#eef2ff;color:#0b3bff}
.main{display:flex;gap:12px;padding:8px 12px}
.left{flex:1}
.right{width:360px}
.planCard{background:var(--card);border-radius:12px;padding:8px;box-shadow:0 6px 18px rgba(139,107,59,0.06)}
.planControls{display:flex;gap:8px;align-items:center;margin-bottom:10px}
.planCanvas{position:relative;height:68vh;border-radius:8px;overflow:hidden;background:linear-gradient(180deg,#fffaf2,#f6efe6);border:1px solid rgba(139,107,59,0.08)}
.planCanvas img{position:absolute;left:0;top:0;right:0;bottom:0;width:100%;height:100%;object-fit:contain;object-position:center;z-index:0;background:transparent}
/* If the plan is inlined as an <svg> instead of an <img>, make it fill the canvas too */
.planCanvas svg{position:absolute;left:0;top:0;width:100%;height:100%;z-index:0}
/* subtle grid overlay to aid placement */
.planCanvas:before{ content:''; position:absolute; left:0; top:0; right:0; bottom:0; background-image: linear-gradient(rgba(0,0,0,0.02) 1px, transparent 1px), linear-gradient(90deg, rgba(0,0,0,0.02) 1px, transparent 1px); background-size: 40px 40px, 40px 40px; pointer-events:none; z-index:1 }
.dot{position:absolute;width:18px;height:18px;background:#b05a2b;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-size:12px;transform:translate(-50%,-50%);box-shadow:0 6px 18px rgba(176,90,43,0.12);transition:left 0.6s linear, top 0.6s linear}
.router{position:absolute;width:36px;height:24px;background:var(--accent);color:#fff;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:11px;transform:translate(-50%,-50%);box-shadow:0 6px 18px rgba(139,107,59,0.12);cursor:grab}
.label{position:absolute;font-size:12px;color:#0b2540;transform:translate(-50%,0);margin-top:6px}
.pathLayer{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:2}
.panel{background:var(--card);padding:12px;border-radius:10px;margin-bottom:12px}
.muted{color:var(--muted)}
.json{white-space:pre-wrap;max-height:360px;overflow:auto;background:#fbfdff;padding:8px;border-radius:6px}
.empty{display:flex;align-items:center;justify-content:center;height:100%;color:var(--muted)}

/* Animated segment when a device moves between two points */
.drawSegment{ stroke-dasharray:1000; stroke-dashoffset:1000; animation: drawLine 600ms linear forwards, fadeLine 900ms linear 600ms forwards }
@keyframes drawLine{ to { stroke-dashoffset: 0 } }
@keyframes fadeLine{ from { stroke-opacity: 1 } to { stroke-opacity: 0 } }

/* Overlay helpers for Mantine-wrapped anchors and devices */
.overlay-anchor{ display:flex; flex-direction:column; align-items:center; gap:4px; pointer-events:auto; transform:translate(-50%,-100%); }
.overlay-anchor .mantine-ActionIcon-root{ box-shadow:0 6px 18px rgba(11,92,255,0.12) }
.overlay-device{ display:flex; align-items:center; justify-content:center; pointer-events:auto; transform:translate(-50%,-50%); }

/* Left navigation styles */
.layout-shell{ display:flex }
.leftnav{ width:72px; background:#f2e9dd; display:flex;flex-direction:column;align-items:center;padding:12px 6px;border-right:1px solid rgba(0,0,0,0.06);height:100vh;position:fixed;left:0;top:0;z-index:120;overflow:visible;transition:width 220ms ease }
.leftnav-brand{ width:44px;height:44px;border-radius:8px;background:var(--accent);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;margin-bottom:8px }
.leftnav-item{ width:44px;height:44px;border-radius:8px;display:flex;align-items:center;justify-content:center;color:#4b4336;margin:6px 0;transition:all .15s ease;background:transparent }
.leftnav-item svg{ width:20px; height:20px; display:block; stroke:currentColor; fill:currentColor }
.leftnav-item svg *{ stroke:currentColor; fill:currentColor }
.leftnav-item:hover{ background:rgba(139,107,59,0.12); color:var(--accent) }
.leftnav-item.active{ background:#e7d9c7; color:#493a26 }
/* label next to icon when nav expands */
.leftnav-label{ display:none; margin-left:10px; font-size:13px; color:var(--muted) }
.leftnav:hover{ width:200px }
.leftnav:hover .leftnav-item{ justify-content:flex-start; padding-left:12px; width:calc(100% - 12px) }
.leftnav:hover .leftnav-item.active{ width:calc(100% - 12px) }
.leftnav:hover .leftnav-item:hover{ background:rgba(139,107,59,0.12) }
.leftnav:hover .leftnav-label{ display:inline }

/* animate topbar and content when nav expands */
.topbar{ transition: left 220ms ease, right 220ms ease }
.leftnav:hover ~ .topbar{ left:200px }
.content{ margin-left:72px; transition: margin-left 220ms ease, margin-right 220ms ease; padding-top:56px; width:100% }
.leftnav:hover ~ .content{ margin-left:200px }

/* Right panel spacing handled inline via panelOpen prop; class-based rules removed to avoid conflicts */

/* control pills */
.control-pill{border-radius:999px;padding:8px 12px;border:1px solid rgba(139,107,59,0.08);background:transparent}
.control-pill.primary{background:var(--accent);color:#fff;border:none}

/* shift main container to account for fixed left nav */
 .app > .mantine-Container{ margin-left:0 }

/* shift the entire app to the right so fixed left nav doesn't overlap content */
.app{ margin-left:16px; padding-top:0 }
/* small screen tweak: reduce left nav and margins */
@media (max-width: 900px){
	/* Hide left nav on small screens and reset offsets so nothing is left behind */
	.leftnav{ display:none }
	/* topbar is positioned fixed using `left`; reset it to 0 when nav is hidden */
	.topbar{ left:0 !important; right:0 }
	/* content and app should not keep left margins when nav is hidden */
	.content{ margin-left:0; padding-top:56px }
	.app{ margin-left:0; padding-top:0 }
	.app > .mantine-Container{ margin-left:0 }
}

/* Ensure SVG path layer spans the plan and stays above the image but under interactive badges */
.pathLayer{ position:absolute; left:0; top:0; width:100%; height:100%; pointer-events:none; z-index:3 }
